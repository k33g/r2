{"version":3,"sources":["@traceur/generated/TemplateParser/3","@traceur/generated/TemplateParser/4","/Users/k33g_org/Dropbox/Public/r2/src/r2/Request.js","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/1","/Users/k33g_org/Dropbox/Public/r2/src/tests.js"],"names":[],"mappings":"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","sourcesContent":["var __moduleName = $__placeholder__0;","var $__placeholder__0 = $__placeholder__1","/*\n#R2 Request\n\n##GET\n\n    new Request(\"/humans\").get().then((data) => {\n      console.log(data);\n    })\n\n    new Request(\"/humans/hFPDywuRsPdJM7Fa\").get()\n      .then((data)=>{\n        console.log(data);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n\n##POST\n\n    new Request(\"/humans\")\n      .post({firstName:\"Philippe\", lastName:\"Charrière\"})\n      .then((data) => {\n        console.log(data);\n      })\n      .catch((error) => {\n        console.log(error);\n      })\n\n##PUT\n\n    new Request(\"/humans/yk7LXLlHXFD9Uch2\")\n      .put({firstName:\"Tony\", lastName:\"Stark\"})\n      .then((data) => {\n        console.log(data);\n      })\n      .catch((error) => {\n        console.log(error);\n      })\n\n##DELETE\n\n    new Request(\"/humans/hFPDywuRsPdJM7Fa\").delete()\n      .then((data)=>{\n        console.log(data);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n\n##JSONP\n\n    new Request(\"http://www.geonames.org/postalCodeLookupJSON\")\n      .jsonp(\"postalcode=15261&country=US\")\n      .then((data) => {\n        console.log(\"JSONP (postalCodeLookupJSON):\", data);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n\n\n */\nclass Request {\n\n  constructor (url) {\n    this.request = new XMLHttpRequest();\n    this.url = url;\n  }\n\n  url (url) {\n    this.url = url;\n    return this;\n  }\n\n  jsonp (params) {\n\n    return new Promise((resolve, reject) => {\n\n      this.callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());\n\n      var script = document.createElement('script');\n      script.id = this.callbackName;\n\n      window[this.callbackName] = (data) => {\n        delete window[this.callbackName];\n        var findScript = document.querySelector(\"#\"+this.callbackName);\n        findScript.parentElement.removeChild(findScript);\n        resolve(data);\n      };\n\n      script.src = this.url + (this.url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + this.callbackName +(params === undefined ? \"\" : \"&\"+params);\n\n      document.body.appendChild(script);\n\n      script.onerror = (error) => {\n        reject(error);\n      }\n    });\n\n  }\n\n  sendRequest () { /*json or text only*/\n\n    return new Promise((resolve, reject) => {\n      this.request.open(this.method, this.url);\n      this.request.onload = () => {\n        // If the request was successful\n        if (this.request.status === 200) {\n          // Get the type of the response\n          var type = this.request.getResponseHeader(\"Content-Type\");\n          // Check type\n          if (type === \"application/json\") {\n            resolve(JSON.parse(this.request.response)); // JSON response\n          } else {\n            resolve(this.request.response); // String response\n          }\n        } else { /* oups */\n          reject(Error(this.request.statusText));\n        }\n      }\n      // Handle network errors\n      this.request.onerror = function() {\n        reject(Error(\"Network Error\"));\n      };\n\n      this.request.setRequestHeader(\"Content-Type\", \"application/json\");\n      this.request.send(this.method === undefined ? null : JSON.stringify(this.data));\n    });\n  }\n\n  get (id) {\n    this.url = id === undefined ? this.url : this.url + \"/\" + id;\n    this.method = \"GET\";\n    return this.sendRequest();\n  }\n\n  post (jsonData) {\n    this.method = \"POST\";\n    this.data = jsonData;\n    return this.sendRequest();\n  }\n\n  put (jsonData, id) {\n    this.url = id === undefined ? this.url : this.url + \"/\" + id;\n    this.method = \"PUT\";\n    this.data = jsonData;\n    return this.sendRequest();\n  }\n\n  delete (id) {\n    this.url = id === undefined ? this.url : this.url + \"/\" + id;\n    this.method = \"DELETE\";\n    return this.sendRequest();\n  }\n}\n\nexport default Request;\n\n","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)","var $__default = $__placeholder__0","return $__placeholder__0","get $__placeholder__0() { return $__placeholder__1; }","import Request from './r2/Request';\n\nvar body = document.querySelector('body');\n\n//=== JSONP tests ===\nnew Request(\"http://www.cjihrig.com/development/jsonp/jsonp.php\")\n  .jsonp(\"message=Hello\")\n  .then((data) => {\n    body.innerHTML += \"<b>JSONP(cjihrig.com):</b><br>\";\n    console.log(\"JSONP:\", data);\n    body.innerHTML += `<p>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  });\n\n\n//http://www.geonames.org/postalCodeLookupJSON?postalcode=15261&country=US&callback=jsonpCallback\nnew Request(\"http://www.geonames.org/postalCodeLookupJSON\")\n  .jsonp(\"postalcode=15261&country=US\")\n  .then((data) => {\n    body.innerHTML += \"<b>JSONP(geonames.com):</b><br>\";\n    console.log(\"JSONP (postalCodeLookupJSON):\", data);\n    body.innerHTML += `<p>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  });\n\n//=== GET Tests ===\n\nvar request = new Request(\"/humans\");\n\nrequest.get().then((data) => {\n  console.log(data);\n  body.innerHTML += \"<b>Get all Humans:</b><br>\";\n  data.forEach( (human) => { body.innerHTML += `<p>${JSON.stringify(human)}</p>`; });\n})\n\nnew Request(\"/humans/hFPDywuRsPdJM7Fa\").get()\n  .then((data)=>{\n    console.log(\"hFPDywuRsPdJM7Fa:\", data);\n    body.innerHTML += `<p>Get one Human:<br>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  });\n\nnew Request(\"/humans\").get(\"hFPDywuRsPdJM7Fa\")\n  .then((data)=>{\n    console.log(\"Bis: hFPDywuRsPdJM7Fa:\", data);\n    body.innerHTML += `<p>Get an other Human:<br>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  });\n\nnew Request(\"/animals/hFPDywuRsPdJM7Fa\").get()\n  .then((data)=>{\n    console.log(data);\n    body.innerHTML += `<p>Get an Animal:<br>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n    body.innerHTML += `<p>Error:<br>${error.message}</p>`;\n  });\n\n\n//=== POST Tests ===\n\nnew Request(\"/humans\")\n  .post({firstName:\"Philippe\", lastName:\"Charrière\"})\n  .then((data) => {\n    console.log(\"POST Results:\", data);\n    body.innerHTML += `<p>Create a Human:<br>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  })\n\n//=== PUT Tests ===\n\nnew Request(\"/humans/yk7LXLlHXFD9Uch2\")\n  .put({firstName:\"Tony\", lastName:\"Stark\"})\n  .then((data) => {\n    console.log(\"PUT Results:\", data);\n    body.innerHTML += `<p>Update a Human:<br>${JSON.stringify(data)}</p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  })\n\n//=== String Response ===\n\nnew Request(\"/README.md\")\n  .get()\n  .then((data) => {\n    console.log(\"GET String response Results:\", data);\n    body.innerHTML += `<p>Load a file:<br><code><pre>${data}</pre></code></p>`;\n  })\n  .catch((error) => {\n    console.log(error);\n  })"]}